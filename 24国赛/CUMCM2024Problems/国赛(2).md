地分为三大种：

- 只能种一季粮食【非水稻】的土地
- 能种一季粮食【水稻】或者蔬菜的土地
- 能种蔬菜、蔬菜或者蔬菜、食用菌的土地
- 根据题目说明，我们根据23年的土地，判断是否有种植豆类



农作物分为三种：粮食、蔬菜、食用菌

- 无论种在哪里，农作物



可以看到不同的农作物在不同的地中、不同的季节的产量、成本、售价都不同



约束：

- 地的种类约束
- 销售量和土地面积限制
- 时间上：不能连续种植；要有豆类植物种植
  - 
- 不能太分散、也不能太小
  - 直接设置不能小于多少的种植面积
  - 一块地只能最多种植两种作物？
  - 



如何理解当季？当水浇地和大棚的季节时间存在重叠时应该怎么处理？

预期销售量：数据里面是肯定没有的，所以用同一季节的不同地种植的作物的加在一起

- 那么如何考虑水浇地和大棚的季节时间存在重叠？且收获时间也不知道，怎么判定是否为同一季节？
- 只有第一季的时候蔬菜种植完全相同，其他时候均不同
- 根据提交文件的格式，最终确认只要划分为第一季和第二季就可以了



最优种植方案：是每一年最大收益还是全部年份的最大收益？



### 最大的问题

如何设置变量？首先，设置每块地种植某种农作物为x肯定是不合理的，变量太多，约束条件也太多；

假如设置某种地种植农作物多少为x，在根据每块地的限制，求解x应该怎么分配：可能会出现第二个规划无解的情况

**双层规划？**

**动态规划？**

**运输问题？**

假设$t$代表的是季为单位

假设某块地$i$要种植农作物$j$的量为$x_{ijt}$，对应y为二元决策变量；有约束：种植面积约束,其中$s_i$表示对应地的面积
$$
\sum_{j=1}^{n_i}x_{ijt}<=s_i,i=1,2,3...,t=1,2,3...
$$
前后年不种相同的
$$
y_{ijt}+y_{ij(t+1)}<=1,t=0,1,2,...j=1,2,3...
$$
豆类植物种植
$$
\sum_{j∈豆类}x_{ijt}+x_{ij(t-1)}+x_{ij(t-2)}>s_i,i=1,2,3...t=2,3,4...
$$
不能太分散：
$$
\sum_{i=1}y_{ijt}<=N,j=1,2,3...t=0,1,2...
$$
不能太小：
$$
x_{ijt}/s_i>=M\%*y_{ijt}
$$
约束
$$
x_{ijt}<=MMy_{ijt}
$$
MM是一个非常大的数



**目标函数**

有种植成本$B_t$：$b_{ij}$表示地$i$上农作物$j$的成本价格
$$
\sum_{j=1}^{n}\sum_{i=1}b_{ij}*x_{ijt},t=1,2,3...
$$
有销售利润$S_t$：$s_{j}$表示农作物$j$的售价；$pro_{ij}$表示地$i$上农作物$j$的亩产量，$exp_j$表示预期销售量;$\theta$表示超出部分的折扣利润率
$$
\sum_{j=1}^{n}s_{j}*min\{\sum_{i=1}x_{ijt}*pro_{ij},exp_{j}\}+\theta*\sum_{j=1}^{n}s_{j}*max\{\sum_{i=1}^{3}x_{ijt}*pro_{ij}-exp_{j},0\},t=1,2,3...
$$
变成
$$
\sum_{j=1}^{n}s_{j}*output+\theta*\sum_{j=1}^{n}s_{j}*remain,t=1,2,3...\\
output<=\sum_{i=1}x_{ijt}*pro_{ij}\\
output<=exp_{j}\\
remain>=0\\
remain>=\sum_{i=1}x_{ijt}*pro_{ij}-exp_{j}
$$
目标函数为：
$$
max\sum_{t=1}^{7}S_t-B_t
$$


**三个是否要和在一起？水稻怎么处理？**
$$
max\sum_{t=2}^{15}S_t-B_t
$$
变成
$$
max\sum_{T=1,2,3...}S_T-B_T+\sum_{t=3,5,7...}S_t-B_t(i∈智能大棚)\\
$$
对于约束条件：

**农作物$j$在不同的$i$归属下，在$t$奇偶性不同时的种类不同；**

假设某块地$i$要种植农作物$j$的量为$x_{ijt}$，有约束：种植面积约束,其中$s_i$表示对应地的面积
$$
\sum_{i不属于智能大棚}x_{ijT}+\sum_{i∈\{智能大棚\}}x_{ij2T}<=s_i,T=1,2,3...7\\
\sum_{i∈\{智能大棚\}}x_{ijt}<=s_i,t=3,5...15
$$
豆类植物种植【对于水浇地和普通大棚，还是三年，如果是智能大棚的话，就是如此】
$$
\sum_{j∈豆类}x_{ijt}+x_{ij(t-1)}+x_{ij(t-2)}+x_{ij(t-3)}+x_{ij(t-4)}+x_{ij(t-5)}>=s_i,i∈\{智慧大棚\},t=5,6,7...\\
\sum_{j∈豆类}x_{ijT}+x_{ij(T-1)}+x_{ij(T-2)}>=s_i,i不属于智慧大棚,T=2,3,4...\\
$$
不能太分散：
$$
\sum_{i不属于智能大棚}y_{ijT}+\sum_{i∈\{智能大棚\}}y_{ij2T}<=N,j=1,2,3...T=1,2,3...\\
\sum_{i∈\{智能大棚\}}y_{ijt}<=N,j=1,2,3...t=1,3,5...\\
$$
不能太小：
$$
x_{ijT}/s_i>=M\%*y_{ijT},i不属于智能大棚,j=1,2,3...,T=1,2,3...\\
x_{ijt}/s_i>=M\%*y_{ijt},i∈\{智能大棚\},j=1,2,3...,t=1,2,3...\\
$$
前后年不种相同的
$$
y_{ijT}+y_{ij(T+1)}<=1,T=0,1,2...j∈\{水稻\}\\
y_{ijt}+y_{ij(t+1)}<=1,t=1,2...i∈\{智慧大棚\}
$$




智慧大棚的预计销售量第二季怎么衡量

水浇地中，通过计算可以发现，任意一种作物的亩利润都比水稻的亩利润高，那么不论第二季种植什么，种植两季的方式也会比种植水稻高；不论考虑两季度还是一季度， 水稻的利润都是最小的，因此会被最后考虑？

智慧大棚把时间相关乘二就行；另外两个不考虑前后年的就行





问题二多产的怎么出售

认为降价出售

假设变化服从正态分布，那么期望产量种多少【x】,那么实际产量【x'】就是关于x的一个正态分布【3$\sigma$原则】，有一个概率密度函数；预期销售量【y,确定值】也有一个概率密度函数，那么可以根据利润减成本来获得一个概率密度函数，根据概率密度函数的期望最大来决定种植的期望产量

用蒙特卡洛模拟去求解？





统一这么设置：亩产量、其他农作物的预期销售量认为服从正态分布【以题目中给出的范围做3$\sigma$原则】；粮食类的销售价格不变；羊肚菌销售价格下降幅度固定；种植成本增长、销售价格增长取自身的0.9和1.1倍作为正态分布3$\sigma$原则的边界；小麦增长率、食用菌价格下降率服从均匀分布；**且这些随机量之间均相互独立**

- 小麦和玉米未来的预期销售量有增长的趋势，平均年增长率介于5%~10% 之间，其他农作物未来每年的预期销售量相对于2023年大约有±5%的变化。
- 农作物的亩产量往往会 受气候等因素的影响，每年会有±10%的变化。
- 因受市场条件影响，农作物的种植成本平均每年增长 5%左右。
- 粮食类作物的销售价格基本稳定；
- 蔬菜类作物的销售价格有增长的趋势，平均每年增长5% 左右。
- 食用菌的销售价格稳中有降，大约每年可下降1%~5%，特别是羊肚菌的销售价格每年下降幅 度为5%。



是随机规划中的**期望值模型**，设定变量为每一种农作物的期望产量$x_{jt}$

有种植成本$B_t$：$b_{ijt}$表示地$i$上农作物$j$的成本价格
$$
\sum_{j=1}^{n}\sum_{i=1}b_{ijt}*x_{ijt},t=1,2,3...
$$
其中
$$
b_{ijt}=b_{ij0}*\prod_{i=1}^{t} plantprice_i
$$
有销售利润$S_t$：$s_{jt}$表示农作物$j$的售价；$pro_{ijt}$表示地$i$上农作物$j$的亩产量，$exp_{jt}$表示预期销售量;$\theta$表示超出部分的折扣利润率
$$
\sum_{j=1}^{n}s_{jt}*min\{==\sum_{i=1}x_{ijt}*pro_{ijt}==,exp_{jt}\}+\theta*\sum_{j=1}^{n}s_{jt}*max\{\sum_{i=1}x_{ijt}*pro_{ijt}-exp_{jt},0\},t=1,2,3...
$$
其中
$$
s_{jt}=s_{j0}\prod_{i=1}^{t}sellprice_i,j∈\{蔬菜\}\\
s_{jt}=s_{j0}\prod_{i=1}^{t}mushroomsprice_i,j∈\{食用菌且不是羊肚菌\}\\
s_{jt}=s_{j0}\prod_{i=1}^{t}morelprice_i,j∈\{羊肚菌\}\\
pro_{ijt}=pro_{ij0}\prod_{i=1}^{t}datayield_i\\
exp_{jt}=exp_{j0}\prod_{i=1}^{t}Wheatprice_i,j∈\{小麦、玉米\}\\
exp_{jt}=exp_{j0}*datapresell_i,j不属于小麦、玉米\\
$$


变成
$$
\sum_{j=1}^{n}s_{j}*output+\theta*\sum_{j=1}^{n}s_{j}*remain,t=1,2,3...\\
output<=\sum_{i=1}x_{ijt}*pro_{ij}\\
output<=exp_{j}\\
remain>=0\\
remain>=\sum_{i=1}x_{ijt}*pro_{ij}-exp_{j}
$$
目标函数为：
$$
max\sum_{t=1}^{7}S_t-B_t
$$
利用**SAA**来做

```
import numpy as np

# 定义模拟次数
num_simulations = 1000

# 初始化结果
results = []

for _ in range(num_simulations):
    # 生成随机数据
    random_data = np.random.normal(...)

    # 建立模型
    model = gp.Model()
    x = model.addVar(vtype=gp.GRB.CONTINUOUS, name="x")

    # 定义目标函数和约束
    # ...

    # 求解模型
    model.optimize()

    # 记录结果
    results.append(x.x)

# 计算模拟结果的统计信息
mean_solution = np.mean(results)

```

然后进行一定的可视化分析



农作物之间的关系包括可替代性和互补性：

- 当一种商品的价格上升时，消费者可能会转向其替代品，导致替代品的需求量增加。
- 互补性指的是一种商品的消费往往伴随着另一种商品的消费，两者共同满足消费者的某种需求。

基于《国民经济行业分类》 (GB/T4754—2011) 和《统计用产品分类目录》，将本文的农作物分成以下几类：

- 谷物
- 豆类、薯类
  - 豆类
  - 薯类
- 蔬菜及食用菌
  - 蔬菜
    - 【蔬菜又分为绿叶菜和非绿叶菜、辣椒】
  - 食用菌

[1]王莉婷,李太平.农产品含义与分类的国际比较[J].世界农业,2017,(01):137-141.DOI:10.13856/j.cn11-1097/s.2017.01.022.

基于分类的标准，认为最外一层分类之间没有可替代性；越往下分可替代性越强


==AIDS==

AIDS模型，全称为“几乎理想的需求系统”（Almost Ideal Demand System），是由美国经济学家Angus Deaton和John Muellbauer在1980年提出的一个需求系统模型。该模型用于分析消费者在不同商品之间的消费选择行为，尤其是在估计需求函数时，可以考虑到商品之间的替代和互补关系。
以下是AIDS模型的详细介绍：
### 模型结构
AIDS模型基于以下假设：
1. **预算约束**：消费者的总支出等于其购买所有商品的总价格。
2. **偏好可分性**：消费者的偏好可以分解为商品之间的偏好和商品内的偏好。
3. **价格指数**：存在一个价格指数，可以用来衡量消费者购买力的变化。
  模型的基本形式如下：
  $$
  Q_i = \alpha_i + \beta_i \cdot \ln(P_i) + \sum_j \gamma_{ij} \cdot \ln(P_j) + \xi \cdot I
  $$
  其中：
- \( Q_i \) 是商品i的需求量。
- \( P_i \) 是商品i的价格。
- \( \alpha_i \) 是商品i的自主需求参数。
- \( \beta_i \) 是商品i的价格弹性参数。
- \( \gamma_{ij} \) 是商品i对商品j的交叉价格弹性参数。
- \( \xi \) 是收入弹性参数。
- \( I \) 是消费者的收入或预算。
### 特点
1. **价格和收入的非线性关系**：AIDS模型允许需求量与价格和收入之间存在非线性关系。
2. **系统内的商品关系**：模型考虑了商品之间的替代和互补关系。
3. **需求系统的完整性**：模型能够处理整个消费篮子的需求，而不是单一商品的需求。
4. **灵活的价格和收入弹性**：模型可以估计出不同商品的价格弹性和收入弹性。
### 应用
AIDS模型广泛应用于以下领域：
- **消费者行为分析**：研究消费者如何在不同商品之间做出选择。
- **价格政策分析**：评估价格变化对消费者福利的影响。
- **收入分配研究**：分析不同收入水平的消费者如何分配其预算。
- **市场预测**：预测商品需求对价格和收入变化的反应。
### 估计方法
AIDS模型的估计通常涉及以下步骤：
1. **数据收集**：收集消费者在不同商品上的消费数据、商品价格以及消费者的收入信息。
2. **模型设定**：根据理论设定AIDS模型的结构。
3. **参数估计**：使用统计方法（如两阶段最小二乘法或似不相关回归）来估计模型参数。
4. **检验和验证**：对估计结果进行统计检验和经济意义检验。
AIDS模型是一个强大的工具，因为它能够处理复杂的商品需求系统，并且能够提供关于消费者行为的深入见解。然而，模型的估计通常需要大量的数据和高水平的统计技能。

还有一种主流的探究支出结构的系统，扩展线性支出系统（ELES）但是这种方法没有考虑商品间的替代效应

[1]李鲁,刘佳.基于AIDS模型的中国城乡居民消费的异质性分析[J].河南社会科学,2023,31(01):61-69.